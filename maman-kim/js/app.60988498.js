(function(e){function t(t){for(var c,l,o=t[0],s=t[1],r=t[2],u=0,h=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&h.push(i[l][0]),i[l]=0;for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&(e[c]=s[c]);p&&p(t);while(h.length)h.shift()();return n.push.apply(n,r||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],c=!0,o=1;o<a.length;o++){var s=a[o];0!==i[s]&&(c=!1)}c&&(n.splice(t--,1),e=l(l.s=a[0]))}return e}var c={},i={app:0},n=[];function l(t){if(c[t])return c[t].exports;var a=c[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=c,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)l.d(a,c,function(t){return e[t]}.bind(null,c));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/maman-kim/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var r=0;r<o.length;r++)t(o[r]);var p=s;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"3f27":function(e,t){e.exports={outside:{name:"Dehors",connections:{place:"garage",condition:!0}},garage:{name:"Garage",width:300,height:400,infinite:!0,scrollable:!0,inventory:[{name:"poubelle-1"},{name:"velo-1"},{name:"velo-1"},{name:"velo-1"},{name:"telephone-1"},{name:"telephone-1"},{name:"telephone-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"}],connections:[{place:"palier",condition:!0}],description:"Les sont gris bleu, plutot sale, des d√©chets sont parfaitements tri√©es. Il n'y as pas de porte m√©talique fermant le garage. Seulement grand ouvert. C'est tr√®s lumineu. Une porte donne sur le palier du Rez de chauss√©.\n"},palier:{name:"Palier",width:200,height:400,infinite:!0,scrollable:!0,inventory:[{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"},{name:"publicite-1"}],connections:[{place:"garage",condition:!0},{place:"vestibule",condition:!0}],description:"Le sole est un peu vieu mais plutot propre. Les porte peintent en bleu son en m√©tal avec un √©trange truc en plastique au mileu, Comme une chati√®re en m√©tale avec une jolie d√©coration floral, mais qui apparement servait pour la poste.\n"},vestibule:{name:"Vestibule",width:100,height:200,infinite:!1,scrollable:!1,connections:[{place:"palier",condition:!0},{place:"salle-de-bain",condition:!0},{place:"entree-salle-principale",condition:"empty-inventory"}]},"salle-de-bain":{name:"Salle de bain un peu d√©gueu",connections:[{place:"vestibule",condition:!0}]}}},5346:function(e,t){e.exports={"voiture-1":{name:"Voiture de la proprio",weight:100,width:250,height:500,picto:"üöô",description:"clio grise, plutot ancienne.\n"},"telephone-1":{name:"T√©l√©phone",weight:.5,width:.5,height:.8,picto:"üìû",description:"Samsung android A5 de 2016. L'√©cran est cass√© mais il est toujours fonctionnelle\n"},"velo-1":{name:"V√©lo",weight:10,width:200,height:40,picto:"üö¥‚Äç",description:"R√©cent, presque neuf. Il as l'air ch√®re. Il n'est jamais attach√©.\n"},"poubelle-1":{name:"Poubelle en carte",weight:.7,width:30,height:30,picto:"P",description:"En tr√©s mauvaise √©tat elle set de tris.\n",place:{name:"Poubelle",width:150,height:150,infinite:!0,scrollable:!0,maximumWeight:10,inventory:[{name:"poubelle-2"}]}},"poubelle-2":{name:"Poubelle en carte",weight:.7,width:30,height:30,picto:"P",description:"En tr√©s mauvaise √©tat elle set de tris.\n",place:{name:"Poubelle",width:150,height:150,infinite:!0,scrollable:!0,maximumWeight:10,inventory:[{name:"velo-1"}]}},"publicite-1":{name:"Publicit√©",weight:.01,width:15,height:10,picto:"<img src='objects/publicite.jpg' >",description:"Un flyer pour du poulet frix, beaucoup de couleur, de mauvais gout. Le logo repr√©sente un poulet heureux.\n"},"fictif-1":{name:"fictif",weight:0,width:0,height:0,picto:"d",description:"Debug\n"}}},"56d7":function(e,t,a){"use strict";a.r(t);a("b0c0"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var c=a("a026"),i=a("8c4f"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Vestibule "),a("inventory",{attrs:{name:"vestibule"}})],1)},l=[],o={props:{},computed:{},mounted:function(){this.story.show("Vestibule")}},s=o,r=a("2877"),p=Object(r["a"])(s,n,l,!1,null,null,null),u=p.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Salle de bain "),a("inventory",{attrs:{name:"salle-de-bain"}})],1)},m=[],d={props:{},computed:{}},v=d,b=Object(r["a"])(v,h,m,!1,null,"d75143cc",null),g=b.exports,f=[{path:"/vestibule",component:u,name:"vestibule"},{path:"/salle-de-bain",component:g,name:"salle-de-bain"}],j=f;c["a"].use(i["a"]);var P=new i["a"]({routes:j}),y=P,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"mains"},[a("h3",[e._v("Dans les mains")]),a("inventory",{attrs:{name:"hands","active-place-obj":e.handsObject}}),a("p",{staticClass:"play-mode"},[a("span",{class:"looking"==e.playMode?"selected":"",on:{click:function(t){return e.changePlayMode("looking")}}},[e._v("üëÅ")]),a("span",{class:"picking"==e.playMode?"selected":"",on:{click:function(t){return e.changePlayMode("picking")}}},[e._v("üñê")])]),a("hr"),a("iframe",{ref:"twee",attrs:{src:"twee-build/index.html",id:"twee"}})],1),a("div",{staticClass:"space"},[e.displayPlace&&e.activePlaceObj?a("div",[e.placeStore.places[e.activePlaceName]?a("h3",[e._v(e._s(e.placeStore.places[e.activePlaceName].name))]):e._e(),e.activePlaceObj?a("inventory",{attrs:{name:e.activePlaceName,"active-place-obj":e.activePlaceObj}}):e._e(),a("p",{staticClass:"description"},[e._v(e._s(e.activePlaceObj.description))]),a("div",{staticClass:"places-available"},[e._l(e.activePlaceObj.connections,(function(t){return e.placeStore.places[t.place]?a("button",{on:{click:function(a){return e.goToPlace(t.place)}}},[e._v(" "+e._s(e.placeStore.places[t.place].name)+" ")]):e._e()})),e.activePlaceObj.parentPlace?a("div",["hands"!=e.activePlaceObj.parentPlace?a("button",{on:{click:function(t){return e.goToPlace(e.activePlaceObj.parentPlace)}}},[e._v(" "+e._s(e.placeStore.places[e.activePlaceObj.parentPlace].name)+" ")]):"hands"==e.activePlaceObj.parentPlace?a("button",{on:{click:function(t){return e.goToPlace(e.placeStore.lastActivePlace)}}},[e._v(" "+e._s(e.placeStore.places[e.placeStore.lastActivePlace].name)+" ")]):e._e()]):e._e()],2)],1):e._e()]),a("div",{staticClass:"object"},[e.activeObjectObj?a("h3",[e._v(e._s(e.activeObjectObj.name))]):e._e(),e.activeObjectObj?a("p",[e._v(e._s(e.activeObjectObj.description))]):e._e()]),a("footer",[a("h1",[e._v("Maman Kim")]),e._v(" - "),a("a",{attrs:{href:"http://robinmoretti.eu"}},[e._v("Robin Moretti")]),e._v(" - "),a("p",{on:{click:e.resetGame}},[e._v("reset")])])])},w=[],$={name:"App",components:{},computed:{handsObject:function(){return this.$store.getters["places/handsObject"]},playMode:function(){return this.$store.state.playMode},placeStore:function(){return this.$store.state.places},objectStore:function(){return this.$store.state.objects},displayPlace:function(){return this.placeStore.displayPlace},activePlaceObj:function(){return this.placeStore.places[this.placeStore.activePlace]},activePlaceName:function(){return this.placeStore.activePlace},activeObjectObj:function(){return!!this.objectStore.activeObject&&this.objectStore.objects[this.objectStore.activeObject]},activeObjectName:function(){return this.objectStore.activeObject}},methods:{resetGame:function(){this.$store.dispatch("reset")},resetPlayer:function(){this.$store.commit("places/resetPlayer")},goToPlace:function(e){this.$store.dispatch("places/goTo",e)},changePlayMode:function(e){this.$store.commit("changePlayMode",e)}},mounted:function(){var e=this;setTimeout((function(){e.$store.dispatch("objects/init"),e.$store.dispatch("places/init"),e.$store.dispatch("init")}),300)}},W=$,S=(a("5c0b"),Object(r["a"])(W,O,w,!1,null,null,null)),_=S.exports,x=a("2f62"),k=(a("a434"),{inventory:[]}),M={},N={},A={addObject:function(e,t){e.inventory.push(t)},removeObject:function(e,t){for(var a=0;a<e.inventory.length;a++)e.inventory[a].name==t.name&&e.inventory.splice(a,1)}},T={namespaced:!0,state:k,getters:M,actions:N,mutations:A},I=(a("4de4"),a("3f27")),C=a.n(I),E=a("5346"),L=a.n(E),D={activePlace:null,lastActivePlace:!1,places:{},player:[],playerMaximunWeight:40,playerActualWeight:0,playerWidth:80,playerHeight:80,displayPlace:!1},q={handsObject:function(e){var t={name:"hands",width:e.playerWidth,height:e.playerHeight};return t}},G={init:function(e){var t=e.dispatch,a=e.commit,c=e.state,i=e.rootState;if(a("toggleDisplayPlace",!1),!i.gameStarted)for(var n in a("initPlaces"),a("addAllObjectSpaces"),c.places)c.places[n].inventory&&t("defineInventoryParentPlaces",{inventory:c.places[n].inventory,parentPlaceName:n});a("toggleDisplayPlace",!0),c.activePlace||i.gameStarted||t("goTo","garage")},updatePlaceWeight:function(e,t){var a=e.dispatch,c=e.state,i=e.commit;"hands"==t?(i("resetPlayerWeight"),c.player&&a("getInventoryWeight",{inventory:c.player,targetPlaceName:t})):(i("resetPlaceWeight",t),c.places[t].inventory&&a("getInventoryWeight",{inventory:c.places[t].inventory,targetPlaceName:t}))},getInventoryWeight:function(e,t){for(var a=e.dispatch,c=(e.state,e.commit),i=t.inventory,n=0;n<i.length;n++)c("addWeightToPlace",{placeName:t.targetPlaceName,weight:L.a[i[n].name].weight}),L.a[i[n].name].place&&L.a[i[n].name].place.inventory&&a("getInventoryWeight",{inventory:L.a[i[n].name].place.inventory,targetPlaceName:t.targetPlaceName})},defineInventoryParentPlaces:function(e,t){for(var a=e.dispatch,c=e.commit,i=t.inventory,n=t.parentPlaceName,l=0;l<i.length;l++)L.a[i[l].name].place&&(c("setSpaceParent",{placeName:i[l].name,parentName:n}),a("defineInventoryParentPlaces",{inventory:L.a[i[l].name].place.inventory,parentPlaceName:i[l].name}))},goTo:function(e,t){var a=e.commit,c=e.dispatch;if(a("setActivePlace",t),c("updatePlaceWeight",t),this.$app){var i=this.$app.story.passages.filter((function(e){return e.name==t}));console.log(i),i&&this.$app.story.show(t)}},createNewPlace:function(e,t){var a=e.commit;e.dispatch;a("createNewPlace",t)}},V={resetPlaceWeight:function(e,t){e.places[t].actualWeight=0},resetPlayerWeight:function(e){e.playerActualWeight=0},addWeightToPlace:function(e,t){"hands"==t.placeName?e.playerActualWeight+=t.weight:e.places[t.placeName].actualWeight+=t.weight},setConnectionsToPlaceObject:function(e,t){if(console.log("payload.placeObj.place = "+t.placeObj.place),console.log("state.activePlace = "+e.activePlace),console.log("payload = ",t),console.log("payload = ",t.placeObj.place!==e.activePlace),t.placeObj.place!==e.activePlace){var a=e.places[t.name];console.log("place = ",a),a.connections=[t.placeObj],this.$app.$set(e.places,t.name,a)}},checkPlaceWeight:function(e,t){console.log("checkPlaceWeight = "+t),e.places[t].actualWeight||(e.places[t].actualWeight=this.$app.getPlaceWeight(t))},createNewPlace:function(e,t){this.$app.$set(e.places,t.name,t.place)},toggleDisplayPlace:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"toggle";e.displayPlace="toggle"==e?!e.displayPlace:t},setActivePlace:function(e,t){e.places[t]&&(console.log("setting last active place ..."),console.log("checkAllParent(state.places[place], state.places) = "+R(e.places[t],e.places)),e.lastActivePlace?R(e.places[t],e.places)&&(console.log("setted"),e.lastActivePlace=e.activePlace):e.lastActivePlace=t,e.activePlace=t)},resetPlayer:function(e){e.player=[]},initPlaces:function(e,t){for(var a in C.a){var c=C.a[a];c.actualWeight=0,c.haveEnoughSpace=!1,this.$app.$set(e.places,a,c)}},addAllObjectSpaces:function(e){for(var t in L.a)L.a[t].place&&this.$app.$set(e.places,t,{name:L.a[t].place.name,width:L.a[t].place.width,height:L.a[t].place.height,scrollable:L.a[t].place.scrollable,infinite:L.a[t].place.infinite,maximumWeight:L.a[t].place.maximumWeight,inventory:L.a[t].place.inventory,actualWeight:0,connections:[]})},setSpaceParent:function(e,t){var a=e.places[t.placeName];a.parentPlace=t.parentName,this.$app.$set(e.places,t.placeName,a)},addObject:function(e,t){"hands"!=t.place?e.places[t.place].inventory.push(t.object):e.player.push(t.object),e.places[t.object.name]&&(e.places[t.object.name].parentPlace=t.place)},removeObject:function(e,t){var a=null;a="hands"==t.place?e.player:e.places[t.place].inventory;for(var c=0;c<a.length;c++)if(a[c].name==t.object.name){a.splice(c,1);break}}},H={namespaced:!0,state:D,getters:q,actions:G,mutations:V};function R(e,t){var a=!0;if(e.parentPlace&&"hands"!=e.parentPlace)while(e.parentPlace&&a)e.parentPlace&&"hands"==e.parentPlace?a=!1:e=t[e.parentPlace];return e.parentPlace&&"hands"==e.parentPlace&&(a=!1),a}var J={activeObject:"",objects:null},U={},z={init:function(e){var t=e.commit;t("initObjects")}},B={setActiveObject:function(e,t){console.log(t),e.activeObject=t.name},initObjects:function(e){e.objects=L.a}},K={namespaced:!0,state:J,getters:U,actions:z,mutations:B},F=a("bfa9"),Q=new F["a"]({key:"vuex",storage:window.localStorage});c["a"].use(x["a"]);var X=!1,Y=new x["a"].Store({modules:{player:T,places:H,objects:K},strict:X,state:{playMode:"picking",gameStarted:!1},actions:{init:function(e){e.dispatch;var t=e.commit;e.state;t("startGame")},reset:function(e){e.dispatch,e.commit,e.state}},mutations:{startGame:function(e){e.gameStarted=!0},changePlayMode:function(e,t){e.playMode=t}},plugins:[Q.plugin]}),Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"object",style:e.objectStyle,attrs:{id:e.space+"-"+e.object.name},on:{click:e.picked}},[null!=e.objects&&e.object?a("span",{domProps:{innerHTML:e._s(e.detailObject.picto)}}):e._e()])},ee=[],te={props:{object:Object,space:{type:String}},computed:{handsObject:function(){return this.$store.getters["places/handsObject"]},placesStore:function(){return this.$store.state.places},objects:function(){return this.$store.state.objects.objects},detailObject:function(){return this.objects[this.object.name]},playMode:function(){return this.$store.state.playMode},objectStyle:function(){var e=this.detailObject.width,t=this.detailObject.height;e<20&&(e=20),t<20&&(t=20);var a="width:"+e+"px;";return a+="height:"+t+"px;",a}},methods:{inventoryMaximumWeight:function(e){return"hands"==e?this.placesStore.playerMaximunWeight:this.placesStore.places[e].maximumWeight?this.placesStore.places[e].maximumWeight:0},inventoryWeight:function(e){var t=0;return t="hands"==e?this.placesStore.playerActualWeight:this.placesStore.places[e].actualWeight,t},deleteObject:function(){"hands"!=this.space?this.$store.commit("places/removeObject",{place:this.space,object:this.object}):this.$store.commit("places/removeObject",{place:"hands",object:this.object})},picked:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t),"picking"==this.playMode||t?this.object.name!=this.$store.state.places.activePlace&&("hands"!=this.space?this.objectIspackable("hands")&&(this.$store.commit("places/removeObject",{place:this.space,object:this.object}),this.$store.commit("places/addObject",{place:"hands",object:this.object})):(console.log("this.$store.state.places.activePlace = "+this.$store.state.places.activePlace),this.objectIspackable(this.$store.state.places.activePlace)&&(this.$store.commit("places/removeObject",{place:"hands",object:this.object}),this.$store.commit("places/addObject",{place:this.$store.state.places.activePlace,object:this.object}))),this.$store.dispatch("places/updatePlaceWeight","hands"),this.$store.dispatch("places/updatePlaceWeight",this.$store.state.places.activePlace)):"looking"==this.playMode&&this.displayObject()},displayObject:function(){this.detailObject.place?this.placesStore.places[this.object.name]&&this.$store.dispatch("places/goTo",this.object.name):this.$store.commit("objects/setActiveObject",this.object)},objectIspackable:function(e){var t=!1;t=!(this.inventoryMaximumWeight(e)>0)||this.inventoryWeight(e)+this.detailObject.weight<=this.inventoryMaximumWeight(e);var a=!0,c="hands"==e?80:this.placesStore.places[e].height,i=("hands"==e||this.placesStore.places[e].width,document.querySelector("#"+e+" .fictif").offsetTop-4);return console.log(i),console.log(i),i+this.detailObject.height>=c&&(a=!1),!(!t||!a)}}},ae=te,ce=(a("eb2b"),Object(r["a"])(ae,Z,ee,!1,null,"1f456d40",null)),ie=ce.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"place-inventory",style:e.inventoryStyle,attrs:{id:e.name}},[e._l(e.placeObjects,(function(t,c){return a("p-object",{key:c,attrs:{space:e.name,object:t}})})),a("span",{staticClass:"fictif"},[e._v("f")])],2),a("div",{staticClass:"informations"},[a("p",[e._v("Poid maximum: "+e._s(e.actualWeight)+"/"+e._s(e.maximumWeight))])])])},le=[],oe=(a("a9e3"),a("35b3"),{props:{name:String,activePlaceObj:Object},computed:{actualWeight:function(){var e=0;return e="hands"==this.activePlaceObj.name?this.$store.state.places.playerActualWeight:this.activePlaceObj.actualWeight?this.activePlaceObj.actualWeight:0,e=Math.round(100*(e+Number.EPSILON))/100,e},maximumWeight:function(){if("hands"==this.name)return this.$store.state.places.playerMaximunWeight;if(this.activePlaceObj){if(this.activePlaceObj.maximumWeight)return this.activePlaceObj.maximumWeight}return"‚àû"},inventoryStyle:function(){var e="";return this.activePlaceObj&&this.activePlaceObj.width&&this.activePlaceObj.height&&(e+="width: "+(this.activePlaceObj.width+2)+"px; height: "+this.activePlaceObj.height+"px;"),this.activePlaceObj.scrollable&&(e+="overflow-y: scroll;"),e},placeObjects:function(){if("hands"!=this.name){var e=this.$store.state.places;return e.places[this.name].inventory}e=this.$store.state.places;return e.player},objects:function(){return this.$store.state.objects.objects}},methods:{},mounted:function(){this.$store.dispatch("places/updatePlaceWeight",this.name)}}),se=oe,re=(a("ed68"),Object(r["a"])(se,ne,le,!1,null,null,null)),pe=re.exports;a("f5df1");c["a"].component("PObject",ie),c["a"].component("inventory",pe),c["a"].config.productionTip=!1,window.passage=null,c["a"].mixin({computed:{story:function(){var e=document.getElementById("twee");return!(!e||!e.contentWindow.story)&&e.contentWindow.story}},methods:{updatePassage:function(e){e&&"Introduction"!=e.name&&this.$store.commit("places/setActivePlace",e.name)},getPlaceWeight:function(e){var t=this.$store.state.places,a=t.places[e],c=L.a,i=0;if(a&&a.inventory)for(var n=a.inventory,l=0;l<n.length;l++){var o=c[n[l].name];i+=o.weight}return i}}});var ue=new c["a"]({router:y,store:Y,render:function(e){return e(_)}}).$mount("#app");Y.$app=ue,y.$app=ue,window.$app=ue},"5c0b":function(e,t,a){"use strict";var c=a("9c0c"),i=a.n(c);i.a},"90dc":function(e,t,a){},"9af2":function(e,t,a){},"9c0c":function(e,t,a){},eb2b:function(e,t,a){"use strict";var c=a("90dc"),i=a.n(c);i.a},ed68:function(e,t,a){"use strict";var c=a("9af2"),i=a.n(c);i.a}});
//# sourceMappingURL=app.60988498.js.map